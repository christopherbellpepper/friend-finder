<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Friend Finder Survey</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
  </head>

  <body>
    <div class="container">
      <div class="jumbotron">
        <h1 class="text-center">
          <span class="fa fa-fire"></span> Friend Finder Survey
        </h1>
        <hr />
        <h2 class="text-center">
          Fill this out to find your best match...
        </h2>
        <hr />
        <h3>Name (required)</h3>
        <input type="text" id="name" class="form-control" required />
        <h3>Link to Photo (required)</h3>
        <input type="text" id="photo" class="form-control" required />
        <hr />
        <h3>Question 1</h3>
        <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
        <select class="chosen-select" id="q1">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 2</h3>
        <h4>Generally speaking, you rely more on your experience than your imagination.</h4>
        <select class="chosen-select" id="q2">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 3</h3>
        <h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
        <select class="chosen-select" id="q3">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 4</h3>
        <h4>You rarely do something just out of sheer curiosity.</h4>
        <select class="chosen-select" id="q4">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 5</h3>
        <h4>People can rarely upset you.</h4>
        <select class="chosen-select" id="q5">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 6</h3>
        <h4>It is often difficult for you to relate to other people’s feelings.</h4>
        <select class="chosen-select" id="q6">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 7</h3>
        <h4>In a discussion, truth should be more important than people’s sensitivities.</h4>
        <select class="chosen-select" id="q7">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 8</h3>
        <h4>You rarely get carried away by fantasies and ideas.</h4>
        <select class="chosen-select" id="q8">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 9</h3>
        <h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
        <select class="chosen-select" id="q9">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <hr />

        <h3>Question 10</h3>
        <h4>You feel more energetic after spending time with a group of people.</h4>
        <select class="chosen-select" id="q10">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>

        <br />
        <br />

        <!-- Submit Button -->
        <button
          type="submit"
          class="btn btn-primary btn-lg btn-block"
          id="submit"
        >
          <i class="fa fa-check-circle" aria-hidden="true"></i> Submit
        </button>
      </div>

      <!-- Modal -->
      <div id="results-modal" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">
                &times;
              </button>
              <h2 class="modal-title"><strong>Best Match</strong></h2>
            </div>
            <div class="modal-body">
              <h2 id="match-name"></h2>
              <img
                id="match-img"
                src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg"
                alt=""
              />
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
      <footer class="footer">
        <div class="container">
          <p><a href="/api/friends">API Friends Link</a> |</p>
        </div>
      </footer>
    </div>

    <script type="text/javascript">
      $(document).ready(function() {
        $("#submit").on("click", function() {
          //form validation
          function validateForm() {
            var isValid = true;
            $("#name").each(function() {
              if ($(this).val() === "") {
                isValid = false;
              }
            });
            $("#photo").each(function() {
              if ($(this).val() === "") {
                isValid = false;
              }
            });
            return isValid;
          }
          //if everything is filled
          if (validateForm() == true) {
            //creates a new friend from the values submitted
            var newFriend = {
              name: $("#name")
                .val()
                .trim(),
              profilePic: $("#photo")
                .val()
                .trim(),
              scores: [
                $("#q1").val(),
                $("#q2").val(),
                $("#q3").val(),
                $("#q4").val(),
                $("#q5").val(),
                $("#q6").val(),
                $("#q7").val(),
                $("#q8").val(),
                $("#q9").val(),
                $("#q10").val()
              ]
            };
            //Grabs current URL of website
            var currentURL = window.location.origin;
            //AJAX posts the data to friends API.
            $.post(currentURL + "/api/friends", newFriend, function(data) {
              //Grab the result from the AJAX post so that the best match's name and photo are displayed.
              $("#matchName").text(data.name);
              $("#matchPic").attr("src", data.profilePic);
            });
            // Show the modal with the best match
            $(".modal").modal();
            //clear form after submission
            $("#name").val("");
            $("#photo").val("");
            $("#q1").val("");
            $("#q2").val("");
            $("#q3").val("");
            $("#q4").val("");
            $("#q5").val("");
            $("#q6").val("");
            $("#q7").val("");
            $("#q8").val("");
            $("#q9").val("");
            $("#q10").val("");
          } else {
            alert("Please fill out ALL fields before submitting survey!");
          }
          // return false;
        });
      });
    </script>
  </body>
</html>
